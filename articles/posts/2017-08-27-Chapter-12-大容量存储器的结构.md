@(Operating System)

# Chapter 12 大容量存储器的结构

传输速率（transfer rate）
:	驱动器和计算机之间的数据传输速率

定位时间（positioning time）
:	有时称为随机访问时间（random access time），由寻道时间（seek time）（移动磁臂到所要的柱面所需时间）和旋转等待时间（rotational latency）（等待所要的扇区旋转到磁臂下所需时间）组成。

传送时间（transfer time）
:	即数据传送所需时间。

磁头碰撞（head crash）
:	磁头与磁盘表面接触，磁盘直接杯具，无法修复。

## 12.4 磁盘调度

寻道时间
:	磁臂将磁头移到包含目标扇区的柱面的时间。

旋转延迟
:	磁盘需要将目标扇区转动到磁头下的时间。

磁盘带宽（disk bandwidth）
:	所传递的总的字节数除以从服务请求开始到最后传递结束时的总时间。

每当一个进程需要对磁盘进行I/O操作，它就向操作系统发出一个系统调用，该调用请求指定了一些信息：
1. 操作是输入还是输出？
2. 所传输的磁盘地址是什么？
3. 所传输的内存地址是什么？
4. 所传输的扇区数是多少？

如果所需的磁盘驱动器和控制器空闲，那么该请求会马上处理。如果磁盘驱动器或者控制器忙，那么任何新的服务请求都会加到该磁盘驱动其的处理等待请求队列上。对于一个有多个进程的多道程序设计系统，磁盘队列可能会有多个待处理请求。调度算法如下：

###  12.4.1 FCFS调度

从122到14再到124的大摆动说明了这种调度的问题。

###  12.4.2 SSTF调度
最短寻道时间优先算法

### 12.4.3 SCAN调度

电梯算法，前后走啊走

### 12.4.4 C-SCAN调度

走完立刻返回到磁盘开始，返回时并不处理请求。

### 12.4.5 LOOK调度

在Scan调度的基础上，磁盘只移动到一个方向上最远的请求为止。也有Look和C-Look调度

####12.4.6 磁盘调度算法的选择

SSTF较为普通且很有吸引力，因为它比FCFS的性能要好。
SCAN和C-SCAN对于**磁盘负荷较大**的系统会执行得更好，这是因为它不可能产生饿死问题。

这里所描述的调度算法只考虑了寻道距离。

###12.5 磁盘管理

在磁盘能存储数据之前，它必须分成扇区以便磁盘控制器能读和写。这个过程称为低级格式化low-level formatting（或物理格式化physical formatting）。

为了**使用磁盘存储文件**，操作系统还需要将自己的数据结构记录在磁盘上。这分为两步。第一步是将磁盘分为由一个或多个柱面组成的**分区**（partition）。在分区之后，第二部是**逻辑格式化（logical formatting）**（创建文件系统）。为了提高效率，大多数OS将块集中到一大块，称作簇（cluster）。磁盘I/O通过块来完成，但是文件系统I/O通过簇完成，这样确保了I/O可以进行更多的顺序存取和更少的随机存取。

磁盘分区是按照柱面来分组的。

低级格式化（分扇区） →  分区（分柱面）→ 高级格式化（创建文件系统）

### 12.5.2 引导块
初始化自举（bootstrap）程序。通常保存在只读存储器（ROM）中。

拥有启动分区的磁盘称为**启动磁盘**或**系统磁盘**


### 12.5.3 坏块
控制器可以用备用块来逻辑地替代坏块。这种方案称为扇区备用（sector sparing）或转寄（forwarding）。

## 12.6 交换空间管理

交换空间管理（swap-space management）是操作系统的另一底层任务。虚拟内存使用磁盘空间作为内存的扩充。交换空间设计和实现的主要目的是为虚拟内存提供最佳吞吐量。

### 12.6.2 交换空间位置

交换空间可有两个位置：交换空间在普通文件系统上加以创建，或者是在一个独立的磁盘分区上进行。

## 12.7 RAID结构
哪些raid的可靠性高，raid0，1是什么。奇偶校验块

多种磁盘组织技术，通常统称为**磁盘冗余阵列（RAID）**技术，使系统有机会改善数据存储的可靠性，因为可在多个磁盘上存储冗余信息。

独立磁盘冗余阵列是利用一台磁盘阵列控制器统一管理和控制一组磁盘驱动器，组成一个速度快 、可靠性高的大容量磁盘系统。

RAID是一组物理磁盘驱动器，操作系统把它看作是一个单独的逻辑驱动器；

数据分布在物理驱动器阵列中；

使用冗余的磁盘容量保存奇偶校验信息，从而保证当一个磁盘失败时，数据具有可恢复性；

### 12.7.1 通过冗余改善可靠性

镜像（mirroring）
:	最简单最昂贵，复制每个磁盘

### 12.7.2 通过并行处理改善性能

通过在多个磁盘上分散数据，可以改善传输率。

### 12.7.3 RAID级别

课本P405 了解各个级别的含义！

