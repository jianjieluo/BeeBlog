@(Operating System)

# Chapter 13 I/O输入系统

**设备驱动程序**为I/O子系统提供了统一设备访问接口，就像系统调用为应用程序于操作系统之间提供了统一的标准接口一样。

## 13.2 I/O硬件

总线（bus）
:	一组线和一组严格定义的可以描述在线上传输信息的协议。

### 轮询

控制器通过*状态寄存器的忙位（busy bit）*来显示其状态。主机与控制器之间的基本握手概念：主机处于忙等待或轮询，不断地读取忙位直到忙位被清除。效率可能会比较差。

如果让设备准备好时在通知处理器而不是由CPU轮询外设I/O是否完成，那么效率就会更好。能使外设通知CPU的硬件机制称为**中断（interrupt）**

### 中断

CPU硬件有一条**中断请求线（interrupt-request line. IRL ）**CPU在执行完每条指令猴，都将检测IRL。

总体流程：设备控制器通过中断请求线**发送信号**而引起中断，CPU**捕获**中断并**分发**到中断处理程序中，中断处理程序通过处理设备请求来**清除中断**，然后执行**中断返回**指令使CPU返回中断以前的执行状态。

也有中断优先级等变种。软中断(software interrupt)

### 直接访问内存（DMA）

程序控制I/O（Programmed I/O, PIO）。为了避免用PIO增加CPU负担，将一部分任务（大量传输任务）下放给一个的专用处理器，称为DMA控制器。

DMA控制器与设备控制器之间的握手通过一对被称为`DMA-request`和`DMA-acknowledge`的线来进行。传输过程跳过了CPU，传输完成后，DMA控制器中断CPU，再继续搞事。